sap.ui.define(["./BaseController","sap/ui/core/routing/History","sap/m/MessageBox"],function(e,t,r){"use strict";return e.extend("stockappui.controller.Warehouse",{onInit(){this.getView().addEventDelegate({onAfterShow:()=>this.addFunctionKeyListener(),onAfterHide:()=>this.removeFunctionKeyListener()})},pressKeyOnKeyboard(e){switch(e){case"Enter":this.onWarehouseEnter();break;case"F3":this.onExportExcelFromVM();break;case"F7":case"Escape":this.onNavBack();break}},async onExportExcel(){const e=this.getModelMain();const t=(e.getProperty("/warehouse")||"").trim();if(!t){r.error(this.getI18nText("warehousePlaceholder"));return}try{const e=await this.callAction("ExportPhysicalStockExcel",{warehouse:t});const r="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";let o;if(e?.value?.type==="Buffer"&&Array.isArray(e.value.data)){o=new Blob([new Uint8Array(e.value.data)],{type:r})}else if(e?.type==="Buffer"&&Array.isArray(e.data)){o=new Blob([new Uint8Array(e.data)],{type:r})}else if(e instanceof ArrayBuffer){o=new Blob([new Uint8Array(e)],{type:r})}else if(e?.buffer instanceof ArrayBuffer){o=new Blob([new Uint8Array(e.buffer)],{type:r})}else if(typeof e==="string"){const t=atob(e);const n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);o=new Blob([n],{type:r})}else{throw new Error("Unexpected Excel payload type")}const n=URL.createObjectURL(o);const a=document.createElement("a");a.href=n;a.download="PhysicalStock.xlsx";a.click();URL.revokeObjectURL(n)}catch(e){r.error("Excel export failed")}},onWarehouseEnter(){const e=this.getModelMain();const t=(e.getProperty("/warehouse")||"").trim();if(!t){r.error(this.getI18nText("warehousePlaceholder"));return}this.getRouter().navTo("RouteStorageBin",{warehouse:encodeURIComponent(t)})},onLiveChangeWarehouse(){},onNavBack(){const e=t.getInstance();if(e.getPreviousHash()!==undefined){window.history.go(-1)}}})});
//# sourceMappingURL=Warehouse.controller.js.map